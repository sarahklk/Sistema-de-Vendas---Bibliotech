<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Painel Admin</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
</head>

<body>

<h1>Painel Administrativo</h1>

<div class="tabs">
    <div class="tab active" onclick="showTab('livros')">ðŸ“š Livros</div>
    <div class="tab" onclick="showTab('usuarios')">ðŸ‘¥ UsuÃ¡rios</div>
    <div class="tab" onclick="showTab('compras')">ðŸ’³ Compras</div>
</div>

<div id="livros" class="section active">

    <h2>Adicionar Livro</h2>

    <form method="POST" enctype="multipart/form-data">
        <input type="hidden" name="action" value="add_livro">

        <label>TÃ­tulo:</label>
        <input name="titulo" required>

        <label>Autor:</label>
        <input name="autor" required>

        <label>GÃªnero:</label>
        <input name="genero" required>

        <label>PreÃ§o:</label>
        <input type="number" step="0.01" name="preco" required>

        <label>Upload da capa:</label>
        <input type="file" name="capa_file">

        <label>OU URL da capa:</label>
        <input name="capa_text">

        <label>PrÃ©via:</label>
        <textarea name="previa" required></textarea>

        <button>Salvar Livro</button>
    </form>

    <h2>Livros cadastrados</h2>

    <table>
        <tr>
            <th>ID</th>
            <th>Capa</th>
            <th>TÃ­tulo</th>
            <th>Autor</th>
            <th>AÃ§Ãµes</th>
        </tr>

        {% for l in livros %}
        <tr>
            <td>{{ l.id }}</td>
            <td>
                <img src="/static/capas/{{ l.capa }}" width="50">
            </td>
            <td>{{ l.titulo }}</td>
            <td>{{ l.autor }}</td>
            <td>
                <a class="btn red" href="/admin/livro/excluir/{{ l.id }}">Excluir</a>
            </td>
        </tr>
        {% endfor %}
    </table>

</div>

<div id="usuarios" class="section">

    <h2>UsuÃ¡rios registrados</h2>

    <table>
        <tr>
            <th>ID</th>
            <th>Nome</th>
            <th>Email</th>
            <th>Tipo</th>
            <th>Status</th>
            <th>AÃ§Ãµes</th>
        </tr>

        {% for u in usuarios %}
        <tr>
            <td>{{ u.id }}</td>
            <td>{{ u.nome }}</td>
            <td>{{ u.email }}</td>
            <td>{{ u.tipo }}</td>
            <td>{{ u.status }}</td>

            <td>
                <a class="btn yellow" href="/admin/usuario/admin/{{ u.id }}">Tornar Admin</a>
                <a class="btn" href="/admin/usuario/bloquear/{{ u.id }}">Bloquear</a>
                <a class="btn red" href="/admin/usuario/excluir/{{ u.id }}">Excluir</a>
            </td>
        </tr>
        {% endfor %}
    </table>

</div>


<div id="compras" class="section">

    <h2>HistÃ³rico de Compras</h2>

    <table>
        <tr>
            <th>ID</th>
            <th>UsuÃ¡rio</th>
            <th>Livro</th>
            <th>Status</th>
        </tr>

        {% for c in compras %}
        <tr>
            <td>{{ c.id }}</td>
            <td>{{ c.usuario.nome }}</td>
            <td>{{ c.livro.titulo }}</td>
            <td>{{ c.status }}</td>
        </tr>
        {% endfor %}
    </table>

</div>

<script>
    function showTab(tab) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));

        event.target.classList.add('active');
        document.getElementById(tab).classList.add('active');
    }
</script>

</body>
</html>
